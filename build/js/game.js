"use strict";fetch("/api/get.php?id="+getParams().id).then(function(t){return t.json()}).then(function(t){renderItem(t)});var nowData=[];function renderItem(t){document.getElementsByClassName("game_solo")[0].innerHTML=createItem(t);for(var a=document.getElementsByClassName("stars"),n=document.getElementsByClassName("now_rate"),e=0;e<a.length;e++)!function(e){var s=a[e].querySelectorAll(".star");a[e].addEventListener("mouseover",function(t){n[e].style.cssText="opacity:0",selectStars(t.target.dataset.id,s)}),a[e].addEventListener("mouseout",function(){n[e].style.cssText="",clearStars(s)}),setEventListStarts(e+1,s)}(e);var s=!1,r=document.getElementsByClassName("gsa_left")[0],i=document.getElementsByClassName("gsa_right")[0],c=document.getElementsByClassName("gsa_case")[0];c.innerHTML+=c.innerHTML;var o=document.getElementsByClassName("gsc_item");r.addEventListener("click",function(){if(!s){s=!0;for(var t=0;t<o.length;t++)o[t].style.cssText="transform: translateX(100%);";setTimeout(function(){for(var t=0;t<o.length;t++)o[t].style.cssText="transition:none;transform: translateX(0);";c.insertBefore(o[o.length-1],o[0]),s=!1},500)}}),i.addEventListener("click",function(){if(!s){s=!0;for(var t=0;t<o.length;t++)o[t].style.cssText="transform: translateX(-100%);";setTimeout(function(){for(var t=0;t<o.length;t++)o[t].style.cssText="transition:none;transform: translateX(0);";c.appendChild(o[0]),s=!1},500)}}),nowData=t}function createItem(t){return'\n        <div class="gcisi_head">\n            <h3>'+t.title+'</h3>\n            <a href="/edit/#'+t.id+'" class="gcisi_edit">Править</a>\n        </div>\n        <div class="platform">'+getPlatform(t.platform)+'</div>\n        <div class="gcisi_rate">\n            <div class="gcisi_vis">\n                <div class="now_rate" style="'+getStyleRate(t.id,t.rating)+'"></div>\n                <div class="stars">'+getStarts(t.id)+"</div>\n            </div>\n            <p>"+(parseFloat(t.rating).toFixed(1)||"0.0")+'</p>\n        </div>\n        <div class="price">'+getPrice(t.price)+"</div>\n        <p>Как принято считать, ключевые особенности структуры проекта ограничены исключительно образом мышления. \n        Лишь тщательные исследования конкурентов набирают популярность среди определенных слоев \n        населения, а значит, должны быть подвергнуты целой серии независимых исследований. \n        В своем стремлении повысить качество жизни, они забывают, что граница обучения \n        кадров влечет за собой процесс внедрения и модернизации экспериментов, \n        поражающих по своей масштабности и грандиозности.</p>\n    "+createSlide(t)}function createSlide(t){t=["a947f.jpg","ag33a.jpg","gerh3.jpg","rh5a3.jpg","457efe.jpg"];for(var e='<div class="game_slider"><div class="gs_arrow gsa_left"></div><div class="gsa_case">',s=0;s<t.length;s++)e+='<div class="gsc_item"><div style="background-image: url(/build/res/screen/'+t[s]+')" class="gsci_img"></div></div>';return e+='</div><div class="gs_arrow gsa_right"></div></div>'}function getPlatform(t){return t.reduce(function(t,e){return t+'<div class="platform_item '+e.toLowerCase()+'"><i></i><p>'+e+"</p></div>"},"")}function getRateStyle(t){return"width: "+10*t+"%;"}function getPrice(t){return"0"==t?"Бесплатно":t+" руб."}function getClassVote(t){return(JSON.parse(localStorage.getItem("checkVote"))||[])[t]?"gcib_voteActive":""}function getParams(){return window.location.search.substr(1).split("&").reduce(function(t,e){var s=e.split("=");return t[s[0]]=s[1],t},{})}function getStyleRate(t,e){return getVotesRate(t)?"":"width:"+10*e+"%"}function getStarts(t){for(var e="",s=getVotesRate(t),a=1;a<=10;a++)e+=s<a?'<div data-id="'+a+'" class="star"></div>':'<div data-id="'+a+'" class="star starActive"></div>';return e}function getVotesRate(s){return(JSON.parse(localStorage.getItem("votes"))||[]).reduce(function(t,e){return e.id==s?e.rate:t},0)||0}function selectStars(t,e){for(var s=0;s<e.length;s++)s<t&&e[s].classList.add("starSelect")}function clearStars(t){for(var e=0;e<t.length;e++)t[e].classList.remove("starSelect")}function setEventListStarts(r,t){for(var e=0;e<t.length;e++)t[e].addEventListener("click",function(t){var e=t.target.dataset.id,s=JSON.parse(localStorage.getItem("votes"))||[],a="id="+r+"&rating="+e,n=getVotesRate(r);n&&(a+="&old="+n),fetch("/api/vote.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"},body:a}).then(function(){renderItem(nowData)}),s.push({id:r,rate:e}),localStorage.setItem("votes",JSON.stringify(s))},r)}